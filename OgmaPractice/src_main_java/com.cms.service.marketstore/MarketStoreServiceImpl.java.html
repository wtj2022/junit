<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>MarketStoreServiceImpl.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">MarketCsvTest_DBUnit_Service (2023年6月20日 下午6:23:45)</a> &gt; <a href="../../index.html" class="el_group">OgmaPractice</a> &gt; <a href="../index.html" class="el_bundle">src/main/java</a> &gt; <a href="index.source.html" class="el_package">com.cms.service.marketstore</a> &gt; <span class="el_source">MarketStoreServiceImpl.java</span></div><h1>MarketStoreServiceImpl.java</h1><pre class="source lang-java linenums">package com.cms.service.marketstore;

import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.CollectionUtils;

import com.cms.entity.marketstore.MarketStoreBean;
import com.cms.form.marketstore.MarketStoreForm;
import com.cms.form.marketstore.MarketStoreListForm;
import com.cms.mapper.marketstore.MarketStoreMapper;
import com.exception.BusinessException;

/**
 * ユーザー情報 Service
 */
@Service
<span class="fc" id="L20">public class MarketStoreServiceImpl implements MarketStoreService {</span>

	@Autowired
	MarketStoreMapper mapper;
	@Override
	public MarketStoreListForm select(MarketStoreListForm form) {
		
<span class="fc" id="L27">		MarketStoreBean input = new MarketStoreBean();</span>
		
<span class="fc bfc" id="L29" title="All 2 branches covered.">		if(StringUtils.isNotEmpty(form.getAddress())) {</span>
<span class="fc" id="L30">			input.setAddress(form.getAddress());</span>
		};
<span class="fc bfc" id="L32" title="All 2 branches covered.">		if(StringUtils.isNotEmpty(form.getStoreName())) {</span>
<span class="fc" id="L33">			input.setStoreName(form.getStoreName());</span>
		}
		
<span class="fc" id="L36">		List&lt;MarketStoreBean&gt; results = mapper.select(input);</span>
		
<span class="pc bpc" id="L38" title="1 of 4 branches missed.">		if (results == null || results.size() == 0) {</span>
<span class="fc" id="L39">			throw new BusinessException(&quot;検索結果はありません。&quot;);</span>
		}
		//検索
<span class="fc" id="L42">		form.setResults(results);</span>
		
<span class="fc" id="L44">		return form;</span>
	}
	@Override
	public void insert(MarketStoreForm form) {
<span class="fc" id="L48">				MarketStoreBean bean = new MarketStoreBean();</span>

<span class="fc" id="L50">				String maxId = mapper.selectMaxId();</span>
<span class="fc" id="L51">				String maxStoreId = String.valueOf(Integer.valueOf(maxId) + 1);</span>
				
<span class="fc" id="L53">				bean.setStoreId(maxStoreId);</span>
<span class="fc" id="L54">				bean.setStoreName(form.getStoreName());</span>
<span class="fc" id="L55">				bean.setAddress(form.getAddress());</span>
<span class="fc" id="L56">				bean.setPhone(form.getPhone());</span>
<span class="fc" id="L57">				bean.setStartDay(form.getStartDay());</span>
<span class="fc" id="L58">				bean.setFinishDay(form.getFinishDay());</span>
<span class="fc" id="L59">				mapper.insert(bean);</span>
<span class="fc" id="L60">	}</span>
	@Override
	public MarketStoreForm editInit(MarketStoreForm form) {
		
<span class="fc" id="L64">		MarketStoreBean sqlBean = new MarketStoreBean();</span>
<span class="fc" id="L65">		sqlBean.setStoreId(form.getStoreId());</span>
		
<span class="fc" id="L67">		List&lt;MarketStoreBean&gt; searchResults = mapper.select(sqlBean);</span>
<span class="fc bfc" id="L68" title="All 2 branches covered.">		if (!CollectionUtils.isEmpty(searchResults)) {</span>
<span class="fc" id="L69">			MarketStoreBean result = searchResults.get(0);</span>
<span class="fc" id="L70">			form.setStoreId(result.getStoreId());</span>
<span class="fc" id="L71">			form.setStoreName(result.getStoreName());</span>
<span class="fc" id="L72">			form.setAddress(result.getAddress());</span>
<span class="fc" id="L73">			form.setPhone(result.getPhone());</span>
<span class="fc" id="L74">			form.setStartDay(result.getStartDay());</span>
<span class="fc" id="L75">			form.setFinishDay(result.getFinishDay());</span>
		}

<span class="fc" id="L78">		return form;</span>
	}
	@Override
	public void update(MarketStoreForm form) {
		// TODO 自動生成されたメソッド・スタブ
		// 画面から社員IDを取得する
<span class="fc" id="L84">				String Id = form.getStoreId();</span>
				// ログイン情報を検索する
<span class="fc" id="L86">				MarketStoreBean bean = new MarketStoreBean();</span>
<span class="fc" id="L87">				bean.setStoreId(Id);</span>

<span class="fc" id="L89">				List&lt;MarketStoreBean&gt; results = mapper.select(bean);</span>
<span class="fc" id="L90">				MarketStoreBean updateBean = results.get(0);</span>

				// 8桁不足の場合、前に０を埋める
<span class="fc" id="L93">				updateBean.setStoreId(form.getStoreId());</span>
<span class="fc" id="L94">				updateBean.setStoreName(form.getStoreName());</span>
<span class="fc" id="L95">				updateBean.setAddress(form.getAddress());</span>
<span class="fc" id="L96">				updateBean.setPhone(form.getPhone());</span>
<span class="fc" id="L97">				updateBean.setStartDay(form.getStartDay());</span>
<span class="fc" id="L98">				updateBean.setFinishDay(form.getFinishDay());</span>
<span class="fc" id="L99">				mapper.update(updateBean);</span>
<span class="fc" id="L100">			}</span>
	@Override
	public MarketStoreForm readInit(MarketStoreForm form) {
		/**
		 * 社員情報を初期化する
		 * 
		 * @param form 社員フォーム
		 * @return 社員フォーム
		 */
			// ログイン情報を検索する
<span class="fc" id="L110">		MarketStoreBean sqlBean = new MarketStoreBean();</span>
<span class="fc" id="L111">			sqlBean.setStoreId(form.getStoreId());</span>

<span class="fc" id="L113">			List&lt;MarketStoreBean&gt; searchResults = mapper.select(sqlBean);</span>
<span class="fc bfc" id="L114" title="All 2 branches covered.">			if (!CollectionUtils.isEmpty(searchResults)) {</span>
<span class="fc" id="L115">				MarketStoreBean result = searchResults.get(0);</span>
				
<span class="fc" id="L117">				form.setStoreId(result.getStoreId());</span>
<span class="fc" id="L118">				form.setStoreName(result.getStoreName());</span>
<span class="fc" id="L119">				form.setAddress(result.getAddress());</span>
<span class="fc" id="L120">				form.setPhone(result.getPhone());</span>
<span class="fc" id="L121">				form.setStartDay(result.getStartDay());</span>
<span class="fc" id="L122">				form.setFinishDay(result.getFinishDay());</span>
			}

<span class="fc" id="L125">			return form;</span>
	}
	@Override
	public void delete(String storeId) {
		//社員ID
				
<span class="fc" id="L131">		MarketStoreBean deleteBean = new MarketStoreBean();</span>
<span class="fc" id="L132">				deleteBean.setStoreId(storeId);</span>
<span class="fc" id="L133">				mapper.delete(deleteBean);</span>
<span class="fc" id="L134">	}</span>
	@Override
	public void deleteAll(String storeIds) {
		/**
		 * ユーザー情報を削除する
		 * 
		 * @param form フォーム
		 * @return 検索結果
		 */
<span class="fc" id="L143">			String[] delIds =storeIds.split(&quot;,&quot;);</span>
<span class="fc" id="L144">			mapper.deleteAll(delIds);</span>

<span class="fc" id="L146">	}</span>
	}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>MarketCsvTest_DBUnit_Service (2023年6月20日 下午6:23:45)</div></body></html>